# Story 2.1: Filter and Search Todos

## Status

Ready for Review

## Story

**As a** user,
**I want** to filter todos by completion status,
**so that** I can focus on active tasks or review completed ones.

## Acceptance Criteria

1: Three filter tabs implemented: All, Active, Completed
2: Current filter visually highlighted
3: Todo count updates based on active filter
4: URL updates to reflect current filter (for bookmarking)
5: Filter state persists across sessions
6: Smooth transitions when switching filters
7: Empty states for each filter with appropriate messages
8: Keyboard navigation between filter tabs

## Tasks / Subtasks

- [x] Implement `TodoFilters` component (AC: 1, 2, 8)
  - Create `TodoFilters.tsx` with three filter tabs: "All", "Active", "Completed".
  - Style the active filter to be visually distinct.
  - Implement keyboard navigation between the filter tabs.
- [x] Integrate `TodoFilters` with application state (AC: 3, 4, 5)
  - Connect the component to the `TodoContext` to update the filter state.
  - Ensure the todo count displayed in the application updates based on the selected filter.
  - Use URL hash routing to reflect the current filter in the URL (e.g., `/#/active`).
  - Persist the filter state in `localStorage`.
- [x] Implement filtering logic in `TodoList` (AC: 6, 7)
  - Modify the `TodoList` component to display only the todos that match the current filter.
  - Add smooth transitions when the filter changes.
  - Display an appropriate message when a filter results in an empty list.

## QA Results

### Review Date: 2025-09-25

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

The implementation is of high quality, adhering to the project's architecture and coding standards. The component structure is logical, and the state management is handled correctly.

### Refactoring Performed

- **File**: `src/components/TodoList/TodoList.tsx`
  - **Change**: Memoized the `filteredTodos` array using `useMemo`.
  - **Why**: To prevent re-calculating the filtered list on every render, improving performance when the `todos` prop changes but the filter does not.
  - **How**: Wrapped the filtering logic in a `useMemo` hook with `[todos, filter]` as dependencies.

- **File**: `src/components/TodoFilters/TodoFilters.tsx`
  - **Change**: Wrapped the `TodoFilters` component in `React.memo` and used `useCallback` for the `onFilterChange` handler.
  - **Why**: To prevent the component from re-rendering unnecessarily when its parent component re-renders but the props remain the same.
  - **How**: Exported the component wrapped in `React.memo` and defined the `handleFilterChange` function with `useCallback`.

### Compliance Check

- Coding Standards: ✓
- Project Structure: ✓
- Testing Strategy: ✓
- All ACs Met: ✓

### Improvements Checklist

- [x] Refactored `TodoList` for better performance.
- [x] Refactored `TodoFilters` for better performance.

### Security Review

No security concerns were identified. The application is client-side only and does not handle sensitive data.

### Performance Considerations

Performance was improved by memoizing the `TodoList` filtering and the `TodoFilters` component.

### Files Modified During Review

- `src/components/TodoList/TodoList.tsx`
- `src/components/TodoFilters/TodoFilters.tsx`

### Gate Status

Gate: PASS → docs/qa/gates/2.1-filter-and-search-todos.yml

### Recommended Status

✓ Ready for Done

### Previous Story Insights

- The application is a client-side SPA using React and TypeScript.
- State is managed with the React Context API and a `useReducer` pattern.
- Data is persisted in the browser's `localStorage`.
- Components are styled using CSS Modules.

### Data Models

- **`TodoFilter`**: Represents the current filter state.
  - `status`: 'all' | 'active' | 'completed'
  - `searchTerm`: string (optional)

[Source: docs/architecture.md#data-models]

### Component Specifications

- **`TodoFilters` (Navigation Component)**
  - **Responsibility**: Filter tabs and search functionality.
  - **Key Interfaces**: Filter state management, URL synchronization, active count display.
  - **Dependencies**: `TodoContext`, React Router (for URL sync).
  - **Technology Stack**: React, React Router hooks.

[Source: docs/architecture.md#components]

### File Locations

- `TodoFilters` component: `src/components/TodoFilters/TodoFilters.tsx`
- `TodoFilters` styles: `src/components/TodoFilters/TodoFilters.module.css`
- `TodoFilters` tests: `src/components/TodoFilters/TodoFilters.test.tsx`
- `App.tsx`: `src/App.tsx`
- `main.tsx`: `src/main.tsx`
- `TodoList.tsx`: `src/components/TodoList/TodoList.tsx`
- `TodoList.module.css`: `src/components/TodoList/TodoList.module.css`
- `TodoList.test.tsx`: `src/components/TodoList/TodoList.test.tsx`
- `App.test.tsx`: `src/App.test.tsx`
- `setupTests.ts`: `src/setupTests.ts`

[Source: docs/architecture.md#unified-project-structure]

### Testing Requirements

- Test file location: Alongside component in the same directory.
- Testing frameworks: Jest + React Testing Library.
- Test patterns: Focus on user interactions, mock context dispatches.
- Coverage targets: Minimum 60% for components.

[Source: docs/architecture.md#testing-strategy]
